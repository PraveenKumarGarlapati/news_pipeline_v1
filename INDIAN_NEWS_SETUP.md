# Indian News Pipeline Setup Guide

This guide will help you set up the new Indian News Pipeline script that fetches Indian sports & general news, processes it with Gemini LLM, and stores it in Supabase.

## Required Environment Variables

Add these to your `.env` file:

```bash
# Existing Supabase Configuration
SUPABASE_URL=your_supabase_project_url_here
SUPABASE_KEY=your_supabase_anon_key_here

# News API Configuration (for Indian News Pipeline)
NEWS_API_KEY=your_newsapi_key_here

# Gemini AI Configuration (for Tweet Generation)
GEMINI_API_KEY=your_gemini_api_key_here
```

## Setup Instructions

### 1. NewsAPI Setup (Primary News Source)

1. Go to [NewsAPI.org](https://newsapi.org/)
2. Sign up for a free account
3. Get your API key from the dashboard
4. Add it to your `.env` file as `NEWS_API_KEY`

**Note:** NewsAPI free tier allows 1000 requests per month, which is sufficient for daily runs.

### 2. Gemini AI Setup

1. Go to [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Sign in with your Google account
3. Create a new API key
4. Add it to your `.env` file as `GEMINI_API_KEY`

**Note:** Gemini has a generous free tier for text generation.

### 3. Supabase Table Setup

The script uses the `news_daily` table with this schema:

```sql
create table public.news_daily (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  source text null,
  news json null,
  status boolean null,
  constraint news_daily_pkey primary key (id)
) TABLESPACE pg_default;
```

Make sure this table exists in your Supabase database.

### 4. Install Dependencies

```bash
pip install -r requirements.txt
```

### 5. Run the Script

```bash
python src/indian_news_pipeline.py
```

## How It Works

1. **Fetches News**: Gets top 3 articles from Indian sources (2 general + 1 sports)
2. **Fallback**: If NewsAPI fails, uses RSS feeds from major Indian news outlets
3. **AI Processing**: Sends articles to Gemini to create informational yet funny tweets
4. **Storage**: Stores results in Supabase `news_daily` table

## Data Structure Stored

```json
{
  "source": "indian_news_pipeline",
  "news": {
    "articles": [...],
    "generated_tweet": "...",
    "processing_timestamp": "...",
    "article_count": 3
  },
  "status": true
}
```

## RSS Fallback Sources

If NewsAPI is unavailable, the script falls back to these RSS feeds:
- NDTV News
- Times of India
- The Hindu

## Troubleshooting

- **No articles fetched**: Check your NewsAPI key and internet connection
- **Gemini errors**: Verify your Gemini API key and check quota limits
- **Supabase errors**: Ensure the `news_daily` table exists and credentials are correct
- **Import errors**: Run `pip install -r requirements.txt` to install missing packages

## Running Schedule

You can run this script:
- Manually: `python src/indian_news_pipeline.py`
- Daily via cron job
- Through GitHub Actions (add to existing workflow)

## API Rate Limits

- **NewsAPI Free**: 1000 requests/month
- **Gemini Free**: Very generous limits for text generation
- **Supabase Free**: 500MB database, sufficient for news storage 